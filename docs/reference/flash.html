<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Empirical Bayes matrix factorization — flash • flashier</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Empirical Bayes matrix factorization — flash"><meta property="og:description" content='Fits an empirical Bayes matrix factorization (see Details for a
description of the model). The resulting fit is referred to as a "flash"
object (short for Factors and Loadings using Adaptive SHrinkage). Two
interfaces are provided. The flash function provides a simple
interface that allows a flash object to be fit in a single pass, while
flash_xxx functions are pipeable functions that allow for more
complex flash objects to be fit incrementally (available functions are
listed below under See Also). See the vignettes and
Examples for usage.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flashier</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.53</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/willwerscheid/flashier" class="external-link">Source</a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Empirical Bayes matrix factorization</h1>
    <small class="dont-index">Source: <a href="https://github.com/willwerscheid/flashier/blob/HEAD/R/flash.R" class="external-link"><code>R/flash.R</code></a></small>
    <div class="hidden name"><code>flash.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fits an empirical Bayes matrix factorization (see <strong>Details</strong> for a
description of the model). The resulting fit is referred to as a "flash"
object (short for Factors and Loadings using Adaptive SHrinkage). Two
interfaces are provided. The <code>flash</code> function provides a simple
interface that allows a flash object to be fit in a single pass, while
<code>flash_xxx</code> functions are pipeable functions that allow for more
complex flash objects to be fit incrementally (available functions are
listed below under <strong>See Also</strong>). See the vignettes and
<strong>Examples</strong> for usage.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">flash</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  S <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ebnm_fn <span class="op">=</span> <span class="va">ebnm_point_normal</span>,</span>
<span>  var_type <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  greedy_Kmax <span class="op">=</span> <span class="fl">50L</span>,</span>
<span>  backfit <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  nullcheck <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fl">1L</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>The observations. Usually a matrix, but can also be a sparse
matrix of class <code><a href="https://rdrr.io/pkg/Matrix/man/Matrix.html" class="external-link">Matrix</a></code> or a low-rank matrix
representation as returned by, for example, <code><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></code>,
<code><a href="https://rdrr.io/pkg/irlba/man/irlba.html" class="external-link">irlba</a></code>, <code><a href="https://rdrr.io/pkg/rsvd/man/rsvd.html" class="external-link">rsvd</a></code>, or
<code><a href="https://rdrr.io/pkg/softImpute/man/softImpute.html" class="external-link">softImpute</a></code> (in general, any list that
includes fields <code>u</code>, <code>d</code>, and <code>v</code> will be interpreted
as a low-rank matrix representation).</p></dd>


<dt>S</dt>
<dd><p>The standard errors. Can be <code>NULL</code> (in which case all residual
variance will be estimated) or a matrix, vector, or scalar. <code>S</code>
should be a scalar if standard errors are identical across observations. It
should be a vector if standard errors either vary across columns but are
constant within any given row, or vary across rows but are constant within
any given column (<code>flash</code> will use the length of the vector
to determine whether the supplied values correspond to rows or columns; if the
data matrix is square, then the sense must be specified using parameter
<code>S_dim</code> in function <code><a href="flash_init.html">flash_init</a></code>).</p></dd>


<dt>ebnm_fn</dt>
<dd><p>The function or functions used to solve the empirical Bayes
normal means (EBNM) subproblems. Most importantly, these functions specify
the families of distributions \(G_\ell^{(k)}\) and \(G_f^{(k)}\) to which the
priors on loadings and factors \(g_\ell^{(k)}\) and \(g_f^{(k)}\) are
assumed to belong. If the same function is to be used for both loadings
\(L\) and factors \(F\), then <code>ebnm_fn</code> can be a single function.
If one function is to be used for loadings and a second for factors,
then <code>ebnm_fn</code> should be a list of length two, with the first
element giving the function for loadings and the second the function
for factors. If different functions are to be used for different values of
\(k\), then factor/loadings pairs must be added successively using
multiple calls to either <code><a href="flash_greedy.html">flash_greedy</a></code> or
<code><a href="flash_factors_init.html">flash_factors_init</a></code>.</p>
<p>Any EBNM function provided by package <code><a href="https://rdrr.io/pkg/ebnm/man/ebnm.html" class="external-link">ebnm</a></code> can be
used as input. Non-default arguments to parameters can be supplied using
the helper function <code><a href="flash_ebnm.html">flash_ebnm</a></code>. Custom EBNM functions can
also be used: for details, see <code><a href="flash_ebnm.html">flash_ebnm</a></code>.</p></dd>


<dt>var_type</dt>
<dd><p>Describes the structure of the estimated residual variance.
Can be <code>NULL</code>, <code>0</code>, <code>1</code>, <code>2</code>, or <code>c(1, 2)</code>. If
<code>NULL</code>, then <code>S</code> accounts for all residual variance. If
<code>var_type = 0</code>, then the estimated residual variance (which is added
to any variance given by <code>S</code>) is assumed to be constant
across all observations. Setting <code>var_type = 1</code> estimates a single
variance parameter for each row; <code>var_type = 2</code> estimates one
parameter for each column; and <code>var_type = c(1, 2)</code> optimizes over
all rank-one matrices (that is, it assumes that the residual variance
parameter \(s_{ij}\) can be written \(s_{ij} = a_i b_j\), where the
\(n\)-vector \(a\) and the \(p\)-vector \(b\) are to be
estimated).</p>
<p>Note that if any portion of the residual variance is to be estimated, then
it is usually faster to set <code>S = NULL</code> and to let <code>flash</code>
estimate all of the residual variance. Further, <code>var_type = c(1, 2)</code>
is typically much slower than other options, so it should be used with
care.</p></dd>


<dt>greedy_Kmax</dt>
<dd><p>The maximum number of factors to be added. This will not
necessarily be the total number of factors added by <code>flash</code>, since
factors are only added as long as they increase the variational lower
bound on the log likelihood for the model.</p></dd>


<dt>backfit</dt>
<dd><p>A "greedy" fit is performed by adding up to
<code>greedy_Kmax</code> factors, optimizing each newly added factor in one go
without returning to optimize previously added factors. When
<code>backfit = TRUE</code>, <code>flash</code> will additionally perform a final
"backfit" where all factors are cyclically updated until convergence.
The backfitting procedure typically takes much longer than the greedy
algorithm, but it also usually improves the final fit to a significant
degree.</p></dd>


<dt>nullcheck</dt>
<dd><p>If <code>nullcheck = TRUE</code>, then <code>flash</code> will check
that each factor in the final flash object improves the overall fit. Any
factor that fails the check will be removed.</p></dd>


<dt>verbose</dt>
<dd><p>When and how to display progress updates. Set to
<code>0</code> for none, <code>1</code> for updates after a factor is added or a
backfit is completed, <code>2</code> for additional notifications about the
variational lower bound, and <code>3</code> for updates after every iteration.
It is also possible to output a single tab-delimited table of values
using function <code><a href="flash_set_verbose.html">flash_set_verbose</a></code> with <code>verbose = -1</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A <code>flash</code> object. Contains elements:</p><dl><dt><code>n_factors</code></dt>
<dd><p>The total number of factor/loadings pairs \(K\)
in the fitted model.</p></dd>

<dt><code>pve</code></dt>
<dd><p>The proportion of variance explained by each
factor/loadings pair. Since factors and loadings are not required to be
orthogonal, this should be interpreted loosely: for example, the total
proportion of variance explained could be larger than 1.</p></dd>

<dt><code>elbo</code></dt>
<dd><p>The variational lower bound achieved by the
fitted model.</p></dd>

<dt><code>residuals_sd</code></dt>
<dd><p>Estimated residual standard deviations (these
include any variance component given as an argument to <code>S</code>).</p></dd>

<dt><code>L_pm, L_psd, L_lfsr</code></dt>
<dd><p>Posterior means,
standard deviations, and local false sign rates for loadings \(L\).</p></dd>

<dt><code>F_pm, F_psd, F_lfsr</code></dt>
<dd><p>Posterior means,
standard deviations, and local false sign rates for factors \(F\).</p></dd>

<dt><code>L_ghat</code></dt>
<dd><p>The fitted priors on loadings
\(\hat{g}_\ell^{(k)}\).</p></dd>

<dt><code>F_ghat</code></dt>
<dd><p>The fitted priors on factors
\(\hat{g}_f^{(k)}\).</p></dd>

<dt><code>sampler</code></dt>
<dd><p>A function that takes a single argument
<code>nsamp</code> and returns <code>nsamp</code> samples from the posterior
distributions for factors \(F\) and loadings \(L\).</p></dd>

<dt><code>flash_fit</code></dt>
<dd><p>A <code><a href="flash_fit.html">flash_fit</a></code> object. Used by
<code>flash</code> when fitting is not performed all at once, but
incrementally via calls to various <code>flash_xxx</code> functions.</p></dd>


</dl><p>The following methods are available:</p><dl><dt><code><a href="fitted.flash.html">fitted.flash</a></code></dt>
<dd><p>Returns the "fitted values"
\(E(LF') = E(L) E(F)'\).</p></dd>

<dt><code><a href="residuals.flash.html">residuals.flash</a></code></dt>
<dd><p>Returns the expected residuals
\(Y - E(LF') = Y - E(L) E(F)'\).</p></dd>

<dt><code><a href="ldf.html">ldf.flash</a></code></dt>
<dd><p>Returns an \(LDF\) decomposition (see
<strong>Details</strong> above), with columns of \(L\) and \(F\) scaled
as specified by the user.</p></dd>


</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>If \(Y\) is an \(n \times p\) data matrix, then the rank-one
empirical Bayes matrix factorization model is:
$$Y = \ell f' + E,$$ where \(\ell\) is an
\(n\)-vector of <strong>loadings</strong>, \(f\) is a
\(p\)-vector of <strong>factors</strong>, and \(E\) is an
\(n \times p\) matrix of <strong>residuals</strong> (or "errors").
Additionally:
$$e_{ij} \sim N(0, s_{ij}^2): i = 1, ..., n; j = 1, ..., p$$
$$\ell \sim g_\ell \in G_\ell$$
$$f \sim g_f \in G_f.$$
The residual variance parameters \(s_{ij}^2\) are constrained to have
a simple structure and are fit via maximum likelihood. (For example, one
might assume that all standard errors are identical: \(s_{ij}^2 = s^2\)
for some \(s^2\) and for all \(i\), \(j\)).
The functions \(g_\ell\) and \(g_f\) are assumed to belong to
some families of priors \(G_\ell\) and \(G_f\) that are
specified in advance, and are estimated via variational approximation.</p>
<p>The general rank-\(K\) empirical Bayes matrix factorization model is:
$$Y = LF' + E$$ or
$$y_{ij} = \sum_k \ell_{ik} f_{jk} + e_{ij}: i = 1, ..., n; j = 1, ..., p,$$
where \(L\) is now a matrix of loadings and \(F\) is a matrix of
factors.</p>
<p>Separate priors \(g_\ell^{(k)}\) and \(g_f^{(k)}\) are estimated via
empirical Bayes, and different prior families may be used for different
values of \(k\). In general, then:
$$e_{ij} \sim N(0, s_{ij}^2): i = 1, ..., n; j = 1, ..., p$$
$$\ell_{ik} \sim g_\ell^{(k)} \in G_\ell^{(k)}: i = 1, ..., n; k = 1, ..., K$$
$$f_{ik} \sim g_f^{(k)} \in G_f^{(k)}: j = 1, ..., p; k = 1, ..., K.$$</p>
<p>Typically, \(G_\ell^{(k)}\) and \(G_f^{(k)}\) will be closed under
scaling, in which case \(\ell_k\) and \(f_k\) are only identifiable
up to a <strong>scaling factor</strong> \(d_k\). In other words, we can write:
$$Y = LDF' + E,$$
where \(D\) is a diagonal matrix with diagonal entries \(d_1, ..., d_K\).
The model can then be made identifiable by constraining the scale of
\(\ell_k\) and \(f_k\) for \(k = 1, ..., K\).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Wei Wang and Matthew Stephens (2021).
"Empirical Bayes matrix factorization." <em>Journal of Machine Learning
Research</em> 22, 1--40.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="flash_init.html">flash_init</a></code>, <code><a href="flash_greedy.html">flash_greedy</a></code>,
<code><a href="flash_backfit.html">flash_backfit</a></code>, and <code><a href="flash_nullcheck.html">flash_nullcheck</a></code>. For more
advanced functionality, see <code><a href="flash_factors_init.html">flash_factors_init</a></code>,
<code><a href="flash_factors_fix.html">flash_factors_fix</a></code>, <code><a href="flash_factors_set_to_zero.html">flash_factors_set_to_zero</a></code>,
<code><a href="flash_factors_remove.html">flash_factors_remove</a></code>, <code><a href="flash_set_verbose.html">flash_set_verbose</a></code>, and
<code><a href="flash_set_conv_crit.html">flash_set_conv_crit</a></code>.
For extracting useful data from <code>flash</code> objects, see
<code><a href="fitted.flash.html">fitted.flash</a></code>, <code><a href="residuals.flash.html">residuals.flash</a></code>, and
<code><a href="ldf.html">ldf.flash</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">gtex</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit up to 3 factors and backfit.</span></span></span>
<span class="r-in"><span><span class="va">fl</span> <span class="op">&lt;-</span> <span class="fu">flash</span><span class="op">(</span><span class="va">gtex</span>, greedy_Kmax <span class="op">=</span> <span class="fl">3L</span>, backfit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adding factor 1 to flash object...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adding factor 2 to flash object...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adding factor 3 to flash object...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Wrapping up...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Backfitting 3 factors (tolerance: 6.56e-04)...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Difference between iterations is within 1.0e+01...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Difference between iterations is within 1.0e+00...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Difference between iterations is within 1.0e-01...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Difference between iterations is within 1.0e-02...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Difference between iterations is within 1.0e-03...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Wrapping up...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Nullchecking 3 factors...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># This is equivalent to the series of calls:</span></span></span>
<span class="r-in"><span><span class="va">fl</span> <span class="op">&lt;-</span> <span class="fu"><a href="flash_init.html">flash_init</a></span><span class="op">(</span><span class="va">gtex</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="flash_greedy.html">flash_greedy</a></span><span class="op">(</span>Kmax <span class="op">=</span> <span class="fl">3L</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="flash_backfit.html">flash_backfit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="flash_nullcheck.html">flash_nullcheck</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adding factor 1 to flash object...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adding factor 2 to flash object...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adding factor 3 to flash object...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Wrapping up...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Backfitting 3 factors (tolerance: 6.56e-04)...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Difference between iterations is within 1.0e+01...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Difference between iterations is within 1.0e+00...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Difference between iterations is within 1.0e-01...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Difference between iterations is within 1.0e-02...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Difference between iterations is within 1.0e-03...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Wrapping up...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Nullchecking 3 factors...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit a unimodal distribution with mean zero to each set of loadings</span></span></span>
<span class="r-in"><span><span class="co">#   and a scale mixture of normals with mean zero to each factor.</span></span></span>
<span class="r-in"><span><span class="va">fl</span> <span class="op">&lt;-</span> <span class="fu">flash</span><span class="op">(</span><span class="va">gtex</span>,</span></span>
<span class="r-in"><span>            ebnm_fn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ebnm_unimodal</span>,</span></span>
<span class="r-in"><span>                        <span class="va">ebnm_normal_scale_mixture</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            greedy_Kmax <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adding factor 1 to flash object...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adding factor 2 to flash object...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adding factor 3 to flash object...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Wrapping up...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Nullchecking 3 factors...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit point-laplace priors using a non-default optimization method.</span></span></span>
<span class="r-in"><span><span class="va">fl</span> <span class="op">&lt;-</span> <span class="fu">flash</span><span class="op">(</span><span class="va">gtex</span>,</span></span>
<span class="r-in"><span>            ebnm_fn <span class="op">=</span> <span class="fu"><a href="flash_ebnm.html">flash_ebnm</a></span><span class="op">(</span>prior_family <span class="op">=</span> <span class="st">"point_laplace"</span>,</span></span>
<span class="r-in"><span>                                 optmethod <span class="op">=</span> <span class="st">"trust"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            greedy_Kmax <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adding factor 1 to flash object...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adding factor 2 to flash object...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adding factor 3 to flash object...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Wrapping up...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Nullchecking 3 factors...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit a "Kronecker" (rank-one) variance structure (this can be slow).</span></span></span>
<span class="r-in"><span><span class="va">fl</span> <span class="op">&lt;-</span> <span class="fu">flash</span><span class="op">(</span><span class="va">gtex</span>, var_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, greedy_Kmax <span class="op">=</span> <span class="fl">3L</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adding factor 1 to flash object...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adding factor 2 to flash object...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adding factor 3 to flash object...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Wrapping up...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Nullchecking 3 factors...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jason Willwerscheid, Peter Carbonetto, Wei Wang, Matthew Stephens.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

